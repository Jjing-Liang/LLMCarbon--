name: llm traing basic manifest
description:
  "
  a basic llm manifest
  training-operation-carbon: Wh = GPU-h×(GPU power consumption)×PUE and tCO2eq = MWh × Impact
  you can use sci-m pulgin to calculate the embodied-carbon
  "
tags:
initialize:
  plugins:
    training-operation-carbon-multiply:
      method: Multiply
      path: '@grnsft/if-plugins'
      global-config:
        input-parameters: ['resources-reserved', 'gpu/powerConsumption', 'gpu/duration', 'pue', 'carbonImpact']
        output-parameter: 'training-operation-carbon'
    seconds-per-hour-multiply:
      method: Multiply
      path: '@grnsft/if-plugins'
      global-config:
        input-parameters: ['gpu/duration', 'seconds-per-hour']
        output-parameter: 'duration' # SciM time reserved in seconds
    sci-m:
      method: SciM
      path: '@grnsft/if-plugins'
    sum:
      method: Sum
      path: '@grnsft/if-plugins'
      global-config:
        input-parameters: [ 'training-operation-carbon', 'carbon-embodied' ]
        output-parameter: 'total-carbon'
tree:
  children:
    child:
      total:
        - training-operation-carbon-multiply
        - seconds-per-hour-multiply
        - sci-m # duration & config -> embodied
        - sum
      defaults:
        seconds-per-hour: 3600
        device/emissions-embodied: 1533.120 # in gCO2e for total resource units
        device/expected-lifespan: 5 # 5 years in seconds.
        # Meta’s data centers achieve an average utilization rate of 60% throughout the 5-year lifespan of hardware units
        # ref: Carole-Jean Wu, Ramya Raghavendra, Udit Gupta, Bilge Acun, Newsha Ardalani, Kiwan Maeng, Gloria Chang, Fiona Aga, Jinshi Huang, Charles Bai, et al. Sustainable ai: Environmental impli- cations, challenges and opportunities. Proceedings of Machine Learning and Systems, 4:795–813, 2022.
        resources-reserved: 1 # resource units reserved / used
        resources-total: 1 # total resource units available
      inputs:
        - timestamp: 2023-08-06T00:00
          gpu/powerConsumption: 400 # kWh
          gpu/duration: 82432 # hour
          pue: 1.1
          carbonImpact: 0.385 # the US national average carbon intensity factor of 0.385 kg CO2eq/KWh
